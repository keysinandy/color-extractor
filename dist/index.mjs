var t=function(){function t(t,i){this.options=null!=i?i:{};var n=this.options,a=n.width,o=n.height;this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t.naturalWidth,this.canvas.height=t.naturalHeight,this.width=null!=a?a:t.naturalWidth,this.height=null!=o?o:t.naturalHeight,this.context.drawImage(t,0,0,this.canvas.width,this.canvas.height)}return t.prototype.getImageData=function(){var t=this.options,i=t.offsetX,n=void 0===i?0:i,a=t.offsetY,o=void 0===a?0:a;return this.context.getImageData(n,o,this.width,this.height).data},t}(),i=function(){return i=Object.assign||function(t){for(var i,n=arguments,a=1,o=arguments.length;a<o;a++)for(var e in i=n[a])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},i.apply(this,arguments)},n=function(){function t(t,n){this.bitmap=t;this.options=i(i({},{quality:10,background:{r:255,g:255,b:255},allowWhite:!1}),n)}return t.prototype.getPalette=function(){var t=this.options,i=t.quality,n=t.background,a=t.allowWhite,o=function(t){for(var i=t.bitMap,n=t.quality,a=t.background,o=void 0===a?{r:255,g:255,b:255}:a,e=t.allowWhite,r=[],h=void 0,s=void 0,u=void 0,c=void 0,l=0;l<i.length;l+=4*n){if(h=i[l+0],s=i[l+1],u=i[l+2],(c=i[l+3])<255){var g=c/255;h=h*g+o.r*(1-g),s=s*g+o.g*(1-g),u=u*g+o.b*(1-g)}!e&&h>250&&s>250&&u>250||r.push([h,s,u])}return r}({bitMap:this.bitmap,background:n,quality:i,allowWhite:a});return function(t){for(var i=t.length,n=0,a={r:0,g:0,b:0},o=void 0,e=void 0,r=void 0,h=0;h<i;h+=1)o=t[h][0],e=t[h][1],r=t[h][2],a.r+=o,a.g+=e,a.b+=r,n++;return[~~(a.r/n),~~(a.g/n),~~(a.b/n)]}(o)},t}(),a=function(i,a){void 0===a&&(a={});var o=a.clip,e=a.palette,r=new t(i,o).getImageData();return new n(r,e).getPalette()},o=function(t,i){return void 0===i&&(i={}),new Promise((function(n,o){try{var e=document.createElement("img");e.src=t,e.crossOrigin="anonymous",e.onload=function(){n(a(e,i)),e.remove()}}catch(t){o(t)}}))};export{a as getColor,o as getColorByUrl};
